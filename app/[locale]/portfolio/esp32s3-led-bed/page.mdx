import Link from 'next/link'
import { getDictionary } from '../../../i18n/getDictionary'
import PCBViewer from '../../../components/PCBViewer'

export async function generateMetadata({ params }) {
  return {
    title: 'ESP32-S3 LED Bed — Matrix Controller',
    description: 'High-density LED driving with ESP32-S3, clean power, and connectivity.'
  }
}

export default async function Page({ params }) {
  const locale = params?.locale || 'en'
  const t = await getDictionary(locale)

  return (
    <article className="max-w-4xl">
      <p className="mb-4">
        <Link href={`/${locale}/portfolio`} className="nav-link">
          ← {t.common.backToPortfolio}
        </Link>
      </p>
      
      <h1 className="text-4xl md:text-5xl font-bold text-neutral-900 dark:text-white mb-4">
        ESP32-S3 LED Bed — Matrix Controller
      </h1>
      
      <p className="text-xl text-neutral-600 dark:text-neutral-300 mb-8">
        High-density LED driving with ESP32-S3, clean power, and connectivity.
      </p>

      {/* 3D PCB Viewer */}
      <div className="mb-8">
        <PCBViewer stepFile={null} />
      </div>

      <div className="prose prose-neutral dark:prose-invert max-w-none">
        <h2>Overview</h2>
        <p>A high-performance LED matrix controller built around ESP32-S3 microcontroller. This project demonstrates advanced LED driving techniques, clean power design, and seamless wireless connectivity for creating stunning LED displays.</p>

        <h2>Design Philosophy</h2>
        <p>Flexibility and performance define this project's approach. By leveraging ESP32-S3's powerful dual-core architecture and dedicated peripheral matrix, we created a system capable of driving complex LED patterns with minimal CPU overhead and excellent responsiveness.</p>

        <h2>Key Features</h2>
        <ul>
          <li><strong>High-Density LED Control:</strong> Supports up to 64x64 RGB LED matrices</li>
          <li><strong>ESP32-S3 Dual-Core:</strong> Dedicated core for LED updates, separate for application logic</li>
          <li><strong>Clean Power Design:</strong> Multi-stage filtering and regulation for flicker-free operation</li>
          <li><strong>Wireless Connectivity:</strong> WiFi and BLE for remote control and firmware updates</li>
          <li><strong>Low Latency:</strong> Sub-millisecond response to control commands</li>
        </ul>

        <h2>Technical Implementation</h2>
        <h3>LED Driving Architecture</h3>
        <p>The ESP32-S3's peripheral matrix enables hardware-accelerated LED updates:</p>
        <ul>
          <li><strong>I2S Interface:</strong> Hardware I2S for precise LED data timing</li>
          <li><strong>DMA Transfers:</strong> Zero-CPU LED updates via DMA</li>
          <li><strong>Buffered Output:</strong> Double-buffering for seamless frame updates</li>
          <li><strong>Color Calibration:</strong> Per-LED gamma correction and color temperature adjustment</li>
        </ul>

        <h3>Power System</h3>
        <p>Clean power delivery is essential for consistent LED performance:</p>
        <ul>
          <li><strong>Multi-Stage Filtering:</strong> Pi-filter network for ripple reduction</li>
          <li><strong>High-Current Rail:</strong> Dedicated 5V rail for LED power</li>
          <li><strong>Current Sensing:</strong> Real-time power monitoring</li>
          <li><strong>Thermal Protection:</strong> Over-temperature protection on LED drivers</li>
        </ul>

        <h2>Software Architecture</h2>
        <h3>Firmware Design</h3>
        <p>Efficient software maximizes hardware capabilities:</p>
        <ul>
          <li><strong>FreeRTOS:</strong> Real-time OS for task scheduling</li>
          <li><strong>Hardware Abstraction:</strong> Clean abstraction layer for peripherals</li>
          <li><strong>Protocol Support:</strong> WiFi (TCP/UDP) and BLE for flexible control</li>
          <li><strong>OTA Updates:</strong> Over-the-air firmware updates</li>
        </ul>

        <h3>Connectivity</h3>
        <p>Multiple communication options for different use cases:</p>
        <ul>
          <li><strong>WiFi TCP Server:</strong> Low-latency control over local network</li>
          <li><strong>BLE Central/Peripheral:</strong> Mobile app connectivity and device discovery</li>
          <li><strong>HTTP REST API:</strong> Simple integration with web applications</li>
          <li><strong>Custom Protocol:</strong> Binary protocol for high-bandwidth data transfer</li>
        </ul>

        <h2>Performance Specifications</h2>
        <ul>
          <li><strong>LED Resolution:</strong> Up to 64x64 RGB LEDs</li>
          <li><strong>Frame Rate:</strong> 60 FPS maximum update rate</li>
          <li><strong>Power Consumption:</strong> 200mA @ 5V (64x64, full white)</li>
          <li><strong>Wireless Range:</strong> WiFi 30m, BLE 50m</li>
          <li><strong>Memory:</strong> 8MB PSRAM for frame buffers</li>
          <li><strong>Update Latency:</strong> less than 1ms over WiFi, less than 5ms over BLE</li>
        </ul>

        <h2>Applications</h2>
        <p>This controller is ideal for various LED display applications:</p>
        <ul>
          <li><strong>Digital Signage:</strong> Indoor displays and advertising</li>
          <li><strong>Interactive Installations:</strong> Art installations and museum exhibits</li>
          <li><strong>Gaming Peripherals:</strong> Custom LED controllers for gaming rigs</li>
          <li><strong>Smart Home:</strong> Ambient lighting and notification displays</li>
          <li><strong>Education:</strong> Learning platform for embedded systems</li>
        </ul>

        <h2>Testing & Validation</h2>
        <p>Comprehensive testing ensures reliable operation:</p>
        <ul>
          <li><strong>Stress Testing:</strong> Continuous operation at maximum load for 48+ hours</li>
          <li><strong>EMC Testing:</strong> EMI/EMC compliance for CE/UL certifications</li>
          <li><strong>Thermal Testing:</strong> Operation at ambient temperatures 0-40°C</li>
          <li><strong>Connectivity Testing:</strong> Interoperability with various devices</li>
          <li><strong>Power Analysis:</strong> Detailed power consumption profiling</li>
        </ul>

        <p>This project demonstrates how modern microcontrollers can enable sophisticated LED displays with excellent performance and ease of use.</p>
      </div>
    </article>
  )
}
