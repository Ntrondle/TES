import Link from 'next/link'
import { getDictionary } from '../../../i18n/getDictionary'
import PCBViewer from '../../../components/PCBViewer'

export async function generateMetadata({ params }) {
  return {
    title: 'MicroFlip',
    description: 'Ultra-compact polarity-reverser board for N20-size brushed DC gear-motors.'
  }
}

export default async function Page({ params }) {
  const locale = params?.locale || 'en'
  const t = await getDictionary(locale)

  return (
    <article className="max-w-4xl">
      <p className="mb-6">
        <Link href={`/${locale}/portfolio`} className="text-sm text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-white transition-colors">
          ← {t.common.backToPortfolio}
        </Link>
      </p>
      
      <div className="flex items-center gap-3 mb-4">
        <div className="p-3 rounded-xl bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/20 dark:to-emerald-900/20">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#10b981" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
            <path d="m16 3 4 4-4 4"/>
            <path d="M20 7H4"/>
            <path d="m8 21-4-4 4-4"/>
            <path d="M4 17h16"/>
          </svg>
        </div>
        <h1 className="text-4xl md:text-5xl font-bold text-neutral-900 dark:text-white">
          MicroFlip
        </h1>
      </div>
      <p className="text-xl text-neutral-600 dark:text-neutral-300 mt-4">
        Ultra-compact polarity-reverser board for N20-size brushed DC gear-motors.
      </p>

      <div className="mt-8">
        <PCBViewer stepFile="/models/microflip.glb" />
      </div>

      <div className="prose prose-neutral dark:prose-invert max-w-none mt-12">
        <h2>Overview</h2>
        <p>MicroFlip is a thumb-sized breakout that lets you drive a 3 to 12 V N20 gear-motor in either direction with a single slide. A rugged DPDT switch wired in an H-pattern swaps both motor leads, while an on-board RC snubber suppresses brush noise and protects contacts from arcing. Drop MicroFlip between your motor and your motherboard, and enjoy instant bidirectional control—no microcontroller, no firmware, just flip to drive, flip back to rewind.</p>

        <h2>Design Philosophy</h2>
        <p>Simplicity and reliability define this design. By using a high-quality DPDT switch instead of active electronics, we created a fail-safe, zero-maintenance solution that requires no programming and works under all conditions. The integrated RC snubber protects both switch contacts and motor from the destructive arcing that occurs during switching.</p>

        <h2>Key Features</h2>
        <ul>
          <li><strong>True DPDT Reversal:</strong> Slide switch swaps both motor leads for reliable forward and reverse operation</li>
          <li><strong>Compact Footprint:</strong> Fits inside most micro-robot and lock-actuator housings</li>
          <li><strong>High Current:</strong> Up to 1 A stall current with minimal resistive losses</li>
          <li><strong>Integrated RC Snubber:</strong> 0.1 µF X7R + 120 ohm half-watt series network at motor pins</li>
        </ul>

        <h2>Technical Implementation</h2>
        <h3>Switching Mechanism</h3>
        <p>The DPDT (Double Pole Double Throw) switch is wired in an H-pattern configuration:</p>
        <ul>
          <li><strong>Forward:</strong> Motor leads connected in one polarity</li>
          <li><strong>Reverse:</strong> Motor leads connected in opposite polarity</li>
          <li><strong>Neutral:</strong> Motor disconnected (center-off)</li>
          <li><strong>Switch Type:</strong> DPDT slide switch</li>
        </ul>

        <h3>RC Snubber Network</h3>
        <p>The RC snubber protects switch from destructive arcing during motor switching:</p>
        <ul>
          <li><strong>Capacitor:</strong> 0.1 µF X7R ceramic</li>
          <li><strong>Resistor:</strong> 120 ohm half-watt</li>
          <li><strong>Placement:</strong> Mounted at motor pins</li>
          <li><strong>Protection:</strong> Suppresses voltage spikes</li>
        </ul>

        <h2>Performance Specifications</h2>
        <ul>
          <li><strong>Motor Type:</strong> N20-size brushed DC</li>
          <li><strong>Voltage Range:</strong> 3 V to 12 V</li>
          <li><strong>Current Rating:</strong> 1 A peak (stall)</li>
          <li><strong>Switch Type:</strong> DPDT slide switch</li>
          <li><strong>PCB Layers:</strong> 2-layer, 1 oz copper</li>
          <li><strong>Dimensions:</strong> Thumb-sized footprint</li>
        </ul>

        <h2>Applications</h2>
        <p>MicroFlip is ideal for:</p>
        <ul>
          <li>Micro-Robots</li>
          <li>Lock-Actuators</li>
          <li>Rapid Prototyping</li>
          <li>Educational</li>
          <li>Hobby Projects</li>
        </ul>

        <h2>Hardware Files</h2>
        <ul>
          <li><strong>hardware/:</strong> EasyEDA schematic (JSON), PCB layout (JSON), and Gerber ZIP</li>
          <li><strong>docs/:</strong> 3D board renders, schematic PDF, datasheets</li>
          <li><strong>production/:</strong> Pick-and-place CSV, interactive BOM HTML</li>
        </ul>

        <h2>Mounting Guidelines</h2>
        <ol>
          <li>Ensure proper voltage range (3 V to 12 V)</li>
          <li>Connect motor to castellated pads or JST-PH connector</li>
          <li>Mount switch in accessible location for easy operation</li>
          <li>Test both forward and reverse positions before final assembly</li>
        </ol>

        <div className="my-6 p-6 rounded-2xl border border-red-200 dark:border-red-900 bg-red-50 dark:bg-red-950/20">
          <h2 className="text-xl font-bold text-red-900 dark:text-red-100">Safety Notes</h2>
          <ul>
            <li>Current Limits: For higher currents, use MOSFET H-bridge instead</li>
            <li>Wire Gauge: Use AWG-22 (or larger) for optimal current handling</li>
            <li>Heat Management: Monitor switch temperature at high currents</li>
            <li>Short Circuit: Ensure proper insulation to prevent accidental shorts</li>
          </ul>
        </div>

        <h2>Testing & Validation</h2>
        <ul>
          <li>Switch Testing: Verified DPDT operation in all positions</li>
          <li>Current Testing: Measured 1 A stall current without voltage drop</li>
          <li>Snubber Testing: Verified arcing suppression at switching</li>
          <li>Thermal Testing: Switch temperature under continuous operation</li>
          <li>Connector Testing: Verified castellated pad and JST-PH connections</li>
        </ul>

        <h2>Future Roadmap</h2>
        <ul>
          <li>Higher current versions (2 A, 5 A)</li>
          <li>Integrated current sensing</li>
          <li>LED status indicators</li>
          <li>Multiple motor control variants</li>
        </ul>

        <div className="my-6 p-6 rounded-2xl bg-gradient-to-br from-neutral-100 to-neutral-50 dark:from-neutral-900 dark:to-neutral-950 border border-neutral-200 dark:border-neutral-800 text-center">
          <p>This project demonstrates how simple, well-designed hardware can provide robust motor control without the complexity of microcontrollers or active components.</p>
        </div>
      </div>
    </article>
  )
}
