import Link from 'next/link'
import { getDictionary } from '../../../i18n/getDictionary'
import PCBViewer from '../../../components/PCBViewer'

export async function generateMetadata({ params }) {
  return {
    title: 'Prusa HeatBed Tile PCB',
    description: 'Heated bed controller with precise temperature control and safety features.'
  }
}

export default async function Page({ params }) {
  const locale = params?.locale || 'en'
  const t = await getDictionary(locale)

  return (
    <article className="max-w-4xl">
      <p className="mb-6">
        <Link href={`/${locale}/portfolio`} className="text-sm text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-white transition-colors">
          ← {t.common.backToPortfolio}
        </Link>
      </p>
      
      <div className="flex items-center gap-3 mb-4">
        <div className="p-3 rounded-xl bg-gradient-to-br from-orange-100 to-red-100 dark:from-orange-900/20 dark:to-red-900/20">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ea580c" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
            <path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/>
          </svg>
        </div>
        <h1 className="text-4xl md:text-5xl font-bold text-neutral-900 dark:text-white">
          Prusa HeatBed Tile PCB
        </h1>
      </div>
      <p className="text-xl text-neutral-600 dark:text-neutral-300 mt-4">
        Heated bed controller with precise temperature control and safety features.
      </p>

      <div className="mt-8">
        <PCBViewer stepFile="/models/coaster.glb" />
      </div>

      <div className="prose prose-neutral dark:prose-invert max-w-none mt-12">
        <h2>Overview</h2>
        <p>A robust heated bed controller designed for 3D printers, featuring precise temperature control, multiple sensor inputs, and comprehensive safety features. This project demonstrates advanced power electronics design with PID control and fault protection.</p>

        <h2>Design Philosophy</h2>
        <p>Safety and precision define every aspect of this design. The use of industrial-grade MOSFETs, proper thermal management, and redundant protection circuits ensures reliable operation under demanding 3D printing conditions while maintaining precise temperature control.</p>

        <h2>Key Features</h2>
        <ul>
          <li><strong>Temperature Control:</strong> PID-based precise temperature regulation</li>
          <li><strong>Multiple Sensors:</strong> Support for thermistors and thermocouples</li>
          <li><strong>Power MOSFET:</strong> Industrial-grade N-channel MOSFET for power switching</li>
          <li><strong>Protection Circuits:</strong> Over-current, over-temperature, and short-circuit protection</li>
        </ul>

        <h2>Technical Implementation</h2>
        <h3>Power Stage</h3>
        <p>High-power switching stage with robust protection and efficient thermal management:</p>
        <ul>
          <li><strong>MOSFET:</strong> N-channel power MOSFET (e.g., IRF3205 or equivalent)</li>
          <li><strong>Gate Driver:</strong> Dedicated MOSFET gate driver for fast switching</li>
          <li><strong>Current Rating:</strong> Up to 30 A continuous</li>
          <li><strong>Thermal Path:</strong> Optimized PCB thermal path to heat sink</li>
        </ul>

        <h3>Temperature Sensing</h3>
        <p>Multiple temperature sensor options with signal conditioning:</p>
        <ul>
          <li><strong>Thermistor:</strong> 100k NTC thermistor (standard 3D printer)</li>
          <li><strong>Thermocouple:</strong> K-type thermocouple with MAX6675 amplifier</li>
          <li><strong>Signal Conditioning:</strong> RC filters for noise reduction</li>
          <li><strong>ADC:</strong> 12-bit ADC with oversampling for accuracy</li>
        </ul>

        <h3>PID Control</h3>
        <p>Precision temperature control with adjustable parameters:</p>
        <ul>
          <li><strong>Proportional:</strong> Adjustable gain for response speed</li>
          <li><strong>Integral:</strong> Eliminates steady-state error</li>
          <li><strong>Derivative:</strong> Reduces overshoot and improves stability</li>
          <li><strong>Auto-tune:</strong> Automatic PID parameter tuning</li>
        </ul>

        <h2>Performance Specifications</h2>
        <ul>
          <li><strong>Input Voltage:</strong> 24 V DC</li>
          <li><strong>Current Rating:</strong> 30 A continuous</li>
          <li><strong>Temperature Range:</strong> 20°C to 120°C</li>
          <li><strong>Temperature Accuracy:</strong> ±1°C</li>
          <li><strong>Response Time:</strong> Under 5 seconds to reach setpoint</li>
          <li><strong>Control Frequency:</strong> 1 kHz PWM</li>
        </ul>

        <h2>Applications</h2>
        <p>This heated bed controller is ideal for:</p>
        <ul>
          <li>3D Printing</li>
          <li>Rapid Prototyping</li>
          <li>Temperature-Controlled Surfaces</li>
          <li>Heat-Based Forming</li>
          <li>Industrial Automation</li>
        </ul>

        <h2>Getting Started</h2>
        <ol>
          <li>Connect power supply to VCC/GND terminals</li>
          <li>Connect temperature sensor to thermistor/thermocouple input</li>
          <li>Connect heated bed to output terminals</li>
          <li>Configure PID parameters via configuration interface</li>
          <li>Set target temperature and enable control</li>
        </ol>

        <h2>Testing & Validation</h2>
        <ul>
          <li><strong>Temperature Accuracy:</strong> Verified with calibrated thermometer</li>
          <li><strong>Current Handling:</strong> Full current load testing with thermal monitoring</li>
          <li><strong>PID Performance:</strong> Step response and stability testing</li>
          <li><strong>Protection Circuits:</strong> Over-current and over-temperature fault simulation</li>
          <li><strong>Long-term Operation:</strong> 48+ hours continuous operation</li>
        </ul>
      </div>
    </article>
  )
}
